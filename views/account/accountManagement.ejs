<h1>Account Management</h1>

<!-- Display error messages prominently -->
<div class="error-messages">
    <% if (errors && errors.length) { %>
        <% errors.forEach(error => { %>
            <p class="error"><%= error %></p>
        <% }) %>
    <% } %>
</div>

<div class="account-management-container">
    <p class="management-view">
        Here you can view, reset, or delete user accounts. These actions are available only to employees and managers.
    </p>

    <table class="account-table">
        <thead>
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Account Type</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% if (accounts && accounts.length > 0) { %>
                <% accounts.forEach(account => { %>
                    <tr>
                        <td><%= account.account_firstname %></td>
                        <td><%= account.account_lastname %></td>
                        <td><%= account.account_email %></td>
                        <td><%= account.account_type %></td>
                        <td>
                            <form action="/account/reset/<%= account.account_id %>" method="POST">
                                <input type="password" name="account_password" id="reset-password-<%= account.account_id %>" placeholder="Enter new password" required> 
                                <button type="button" onclick="togglePassword('<%= account.account_id %>')">Show</button>
                                <button type="submit" class="action-btn">Reset Password</button>
                            </form>
                            <form action="/account/delete/<%= account.account_id %>" method="POST" onsubmit="return confirm('Are you sure you want to delete this account?');">
                                <button type="submit" name="account_password" class="action-btn">Delete Account</button>
                            </form>
                        </td>
                    </tr>
                <% }) %>
            <% } else { %>
                <tr>
                    <td colspan="5" class="no-accounts">No accounts found.</td>
                </tr>
            <% } %>
        </tbody>
    </table>
</div>

<script>
function togglePassword(accountId) {
    const passwordField = document.getElementById(`reset-password-${accountId}`);
    passwordField.type = passwordField.type === "password" ? "text" : "password";
}
</script>
